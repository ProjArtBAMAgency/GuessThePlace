openapi: 3.1.0

info:
  title: "GuessThePlace API"
  version: "1.0.0"
  description: >
    API backend du projet GuessThePlace.
    Documentée avec OpenAPI/Swagger pour le cours.

servers:
  - url: http://localhost:3000/api/v1
    description: Serveur local (API v1)

tags:
  - name: Teams
    description: Routes liées aux équipes
  - name: Zones
    description: Routes liées aux zones géographiques
  - name: Posts
    description: Routes related to posts/publications
  - name: Guesses
    description: Routes liées aux tentatives de localisation (guesses)
  - name: Users
    description: Routes related to user management  
  - name: Authentication
    description: Routes related to user authentication
  - name: Profile
    description: Routes related to user profiles

paths:
  /teams:
    get:
      tags:
        - Teams
      summary: Récupérer toutes les équipes
      description: Retourne la liste complète des équipes.
      responses:
        "200":
          description: Liste des équipes récupérée avec succès.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Team"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      tags:
        - Teams
      summary: Créer une nouvelle équipe
      description: >
        Crée une nouvelle équipe.
        Le nom est requis et doit être une chaîne non vide.
        La couleur est optionnelle mais, si présente, doit être une chaîne.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Nom de l'équipe (requis).
                  example: "Team Rocket"
                color:
                  type: string
                  description: Couleur associée à l'équipe (optionnelle).
                  example: "#FF5733"
              required:
                - name
      responses:
        "201":
          description: Équipe créée avec succès.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Team"
        "400":
          description: Données invalides (nom manquant ou mauvais type, couleur incorrecte, etc.).
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /teams/{id}:
    get:
      tags:
        - Teams
      summary: Récupérer une équipe par son ID
      description: Retourne une équipe à partir de son identifiant unique.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de l'équipe (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Équipe trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Team"
        "404":
          description: Équipe non trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /teams/leaderboard:
    get:
      tags:
        - Teams
      summary: Récupérer le classement des équipes
      description: Retourne les équipes triées par score décroissant.
      responses:
        "200":
          description: Classement des équipes récupéré avec succès.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Team"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /zones:
    get:
      tags:
        - Zones
      summary: Récupérer toutes les zones
      description: Retourne la liste complète des zones.
      responses:
        "200":
          description: Liste des zones récupérée avec succès.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Zone"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /zones/{id}:
    get:
      tags:
        - Zones
      summary: Récupérer une zone par son ID
      description: >
        Retourne une zone à partir de son identifiant unique.
        Retourne une erreur 400 si l'ID n'est pas un ObjectId valide.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de la zone (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Zone trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Zone"
        "400":
          description: ID invalide (mauvais format).
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Zone non trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur lors de la récupération de la zone.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /zones/map:
    get:
      tags:
        - Zones
      summary: Récupérer les données GeoJSON des zones
      description: >
        Retourne les données GeoJSON des zones, utilisées pour l'affichage de la carte côté frontend.
      responses:
        "200":
          description: Données GeoJSON des zones.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ZonesGeoJSON"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

# PARTIE SUR LES GUESS
  /guesses:
    get:
      tags:
        - Guesses
      summary: Récupérer toutes les guesses
      description: >
        Retourne la liste complète des guesses avec pagination.
      parameters:
        - name: page
          in: query
          description: "Numéro de page pour la pagination (par défaut: 1)."
          schema:
            type: integer
            default: 1
            example: 1
        - name: limit
          in: query
          description: "Nombre de guesses à retourner par page (par défaut: 20)."
          schema:
            type: integer
            default: 20
            example: 20
      responses:
        "200":
          description: Liste des guesses récupérée avec succès.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Guess"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      tags:
        - Guesses
      summary: Créer une nouvelle guess (tentative de localisation)
      description: >
        Crée une nouvelle tentative de localisation pour un post.
        La distance entre la localisation devinée et la vraie position est calculée,
        et un score est attribué basé sur cette distance.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  description: ID de l'utilisateur qui fait la tentative (MongoDB ObjectId).
                  example: "673a5e8f12c3b9f0a1234567"
                postId:
                  type: string
                  description: ID du post à deviner (MongoDB ObjectId).
                  example: "673a5e8f12c3b9f0a1234567"
                guessedLat:
                  type: number
                  description: Latitude de la position devinée.
                  example: 46.5197
                guessedLon:
                  type: number
                  description: Longitude de la position devinée.
                  example: 6.6323
              required:
                - userId
                - postId
                - guessedLat
                - guessedLon
      responses:
        "201":
          description: Guess créée avec succès.
          content:
            application/json:
              schema:
                type: object
                properties:
                  guess:
                    $ref: "#/components/schemas/Guess"
                  distance:
                    type: number
                    description: Distance en mètres entre la position devinée et la vraie position.
                    example: 150
                  score:
                    type: number
                    description: Score attribué pour cette guess.
                    example: 985
        "400":
          description: Données manquantes ou invalides.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Post non trouvé.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: L'utilisateur a déjà deviné ce post auparavant.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /guesses/{id}:
    get:
      tags:
        - Guesses
      summary: Récupérer une guess spécifique
      description: Retourne une guess à partir de son identifiant unique.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de la guess (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Guess trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Guess"
        "404":
          description: Guess non trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    delete:
      tags:
        - Guesses
      summary: Supprimer une guess
      description: Supprime une guess existante.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de la guess (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Guess supprimée avec succès.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Guess supprimée avec succès"
        "404":
          description: Guess non trouvée.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /guesses/user/{id}:
    get:
      tags:
        - Guesses
      summary: Récupérer toutes les guesses d'un utilisateur
      description: Retourne toutes les tentatives de localisation faites par un utilisateur spécifique.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de l'utilisateur (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Liste des guesses de l'utilisateur récupérée avec succès.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Guess"
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /guesses/user/{id}/globalScore:
    get:
      tags:
        - Guesses
      summary: Récupérer le score global d'un utilisateur
      description: Calcule et retourne le score total (somme de tous les scores) d'un utilisateur.
      parameters:
        - name: id
          in: path
          required: true
          description: ID unique de l'utilisateur (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Score global de l'utilisateur récupéré avec succès.
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: string
                    description: ID de l'utilisateur.
                    example: "673a5e8f12c3b9f0a1234567"
                  totalScore:
                    type: number
                    description: Score total de l'utilisateur (somme de toutes ses guesses).
                    example: 5420
        "500":
          description: Erreur serveur.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
      #  FIN PARTIE SUR LES GUESS

  /posts:
    get:
      tags:
        - Posts
      summary: Retrieve all posts
      description: >
        Returns a list of posts with pagination support.
        Can filter posts by validation status.
      parameters:
        - name: limit
          in: query
          description: "Maximum number of posts to return (default: 40)."
          schema:
            type: integer
            default: 40
            example: 20
        - name: skip
          in: query
          description: "Number of posts to skip for pagination (default: 0)."
          schema:
            type: integer
            default: 0
            example: 0
        - name: isValidated
          in: query
          description: Filter posts by validation status.
          schema:
            type: boolean
            example: true
      responses:
        "200":
          description: List of posts retrieved successfully.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Post"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      tags:
        - Posts
      summary: Create a new post
      description: >
        Creates a new post with an uploaded picture.
        The picture file must be included in the request as multipart/form-data.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                  description: Latitude coordinate of the post location.
                  example: 46.5197
                longitude:
                  type: number
                  description: Longitude coordinate of the post location.
                  example: 6.6323
                picture:
                  type: string
                  format: binary
                  description: Image file to upload (required).
              required:
                - latitude
                - longitude
                - picture
      responses:
        "201":
          description: Post created successfully.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Post"
        "400":
          description: Invalid data (missing picture or invalid coordinates).
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /posts/{id}:
    get:
      tags:
        - Posts
      summary: Retrieve a post by ID
      description: Returns a specific post based on its unique identifier.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the post (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Post found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Post"
        "404":
          description: Post not found.
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    patch:
      tags:
        - Posts
      summary: Update a post
      description: >
        Partially updates a post by its ID.
        Can update latitude, longitude, and validation status.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the post (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                latitude:
                  type: number
                  description: Updated latitude coordinate.
                  example: 46.5197
                longitude:
                  type: number
                  description: Updated longitude coordinate.
                  example: 6.6323
                isValidated:
                  type: boolean
                  description: Validation status of the post.
                  example: true
      responses:
        "200":
          description: Post updated successfully.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Post"
        "404":
          description: Post not found.
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    delete:
      tags:
        - Posts
      summary: Delete a post
      description: Deletes a post based on its unique identifier.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the post (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "204":
          description: Post deleted successfully.
        "404":
          description: Post not found.
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /posts/{id}/picture:
    get:
      tags:
        - Posts
      summary: Retrieve a post's picture
      description: Returns the image file associated with a post.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the post (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "200":
          description: Picture retrieved successfully.
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
            image/*:
              schema:
                type: string
                format: binary
        "404":
          description: Post not found.
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /users/{id}/posts:
    get:
      tags:
        - Posts
      summary: Retrieve posts by user ID
      description: >
        Returns all posts created by a specific user with pagination support.
        Can filter posts by validation status.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the user (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
        - name: limit
          in: query
          description: "Maximum number of posts to return (default: 40)."
          schema:
            type: integer
            default: 40
            example: 20
        - name: skip
          in: query
          description: "Number of posts to skip for pagination (default: 0)."
          schema:
            type: integer
            default: 0
            example: 0
        - name: isValidated
          in: query
          description: Filter posts by validation status.
          schema:
            type: boolean
            example: true
      responses:
        "200":
          description: User's posts retrieved successfully.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Post"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /users:
    get:
      tags:
        - Users
      summary: Retrieve all users - must be authenticated
      description: >
        Returns a list of users with optional pagination and team filtering.
        Use `pagination=true` to enable pagination with `page` and `limit` parameters.
        Use `teamId` to filter users by team.
      parameters:
        - name: pagination
          in: query
          description: "Enable pagination (set to 'true' to activate)."
          schema:
            type: string
            enum: ['true', 'false']
            example: 'true'
        - name: page
          in: query
          description: "Page number for pagination (default: 1). Only used when pagination=true."
          schema:
            type: integer
            default: 1
            example: 1
        - name: limit
          in: query
          description: "Maximum number of users to return per page (default: 10). Only used when pagination=true."
          schema:
            type: integer
            default: 10
            example: 20
        - name: teamId
          in: query
          description: "Filter users by team ID."
          schema:
            type: string
            example: "507f1f77bcf86cd799439011"
      responses:
        "200":
          description: List of users retrieved successfully.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized - Authentication required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Authentication required"
        "403":
          description: Forbidden - Admin privileges required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Admin privileges required"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"

    post:
      tags:
        - Users
      summary: Create a new user
      description: >
        Creates a new user with the provided details.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pseudo:
                  type: string
                  description: "The user's pseudonym."
                  example: "player123"
                email:
                  type: string
                  description: "The user's email address."
                  example: "player123@example.com"
                password:
                  type: string
                  description: "The user's password."
                  example: "securePassword!"
                team_id:
                  type: string  
                  description: "The ID of the team the user belongs to (MongoDB ObjectId)."
                  example: "507f1f77bcf86cd799439011"
                is_admin:
                  type: boolean
                  description: "Indicates if the user has admin privileges."
                  default: false
                  example: true
              required:
                - pseudo
                - email
                - password  
                - team_id
      responses:
        "201":
          description: User created successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "User created successfully."
                  user:
                    $ref: "#/components/schemas/User"
        "400":
          description: Bad request - Invalid data (invalid team ID, username must be between 6 and 10 characters, or invalid email format).
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid team ID"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"

  /users/{id}:
    get:
      tags:
        - Users
      summary: Retrieve a user by ID - must be authenticated
      description: >
        Returns a specific user based on their unique identifier.
      parameters:
        - name: id
          in: path
          description: "The unique identifier of the user."
          required: true
          schema:
            type: string
      responses:
        "200":
          description: User retrieved successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "User retrieved successfully."
                  user:
                    $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized - Authentication required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Authentication required"
        "404":
          description: User not found.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "User not found"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"

    patch:
      tags:
        - Users
      summary: Update a user - must be authenticated and admin
      description: >
        Partially updates a user's details by their ID.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the user (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pseudo:
                  type: string
                  description: Updated pseudonym.
                  example: "newPlayer123"
                email:
                  type: string
                  description: Updated email address.
                  example: "newEmail@email.com"
                password:
                  type: string
                  description: Updated password.
                  example: "newSecurePassword!"
                team_id:
                  type: string
                  description: Updated team ID (MongoDB ObjectId).
                  example: "507f1f77bcf86cd799439011"
                is_admin:
                  type: boolean
                  description: Updated admin status.
                  example: false
      responses:
        "200":
          description: User updated successfully.
          content:  
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "User updated successfully."
                  user:
                    $ref: "#/components/schemas/User"
        "400":
          description: Bad request - Invalid data (invalid team ID, username must be between 6 and 10 characters, or invalid email format).
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Invalid team ID"
        "401":
          description: Unauthorized - Authentication required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Authentication required"
        "403":
          description: Forbidden - Admin privileges required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Admin privileges required"
        "404":
          description: Not found - User or team not found.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "User not found"
        "409":
          description: Conflict - Email or pseudo already in use.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Email already in use"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"
    delete:
      tags:
        - Users
      summary: Delete a user - must be authenticated and admin
      description: Deletes a user based on their unique identifier.
      parameters:
        - name: id
          in: path
          required: true
          description: Unique ID of the user (MongoDB ObjectId).
          schema:
            type: string
            example: "673a5e8f12c3b9f0a1234567"
      responses:
        "204":
          description: User deleted successfully.
        "401":
          description: Unauthorized - Authentication required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Authentication required"
        "403":
          description: Forbidden - Admin privileges required.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Admin privileges required"
        "404":
          description: User not found.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "User not found"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"
  /login:
    post:
      tags:
        - Authentication
      summary: User login
      description: >
        Authenticates a user and returns a JWT token upon successful login. JWT contains user ID and is_admin status.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: "The user's email address."
                  example: "hehe@heig-vd.ch"
                password:
                  type: string
                  description: "The user's password."
                  example: "securePassword!"
              required:
                - email
                - password
      responses:
        "200": 
          description: Login successful.
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: JWT token for authenticated requests. Contain a payload with user ID and is_admin status.
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        "401":
          description: Unauthorized - Invalid email or password.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid email or password"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error"
  /logout:
    post:
      tags:
        - Authentication
      summary: User logout
      description: >
        Logs out a user. Clear the client-side token to complete logout.
      responses:
        "200":
          description: Logout successful.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Logout successful"
        "500":
          description: Server error.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Server error" 

components:
  schemas:
    Team:
      type: object
      properties:
        _id:
          type: string
          description: ID unique de l'équipe (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        name:
          type: string
          description: Nom de l'équipe.
          example: "Team Bleu"
        color:
          type: string
          description: Couleur associée à l'équipe.
          example: "#FF0000"
        score:
          type: number
          description: Score de l'équipe.
          example: 75667
      required:
        - name

    Zone:
      type: object
      description: "Représente une zone géographique du jeu."
      properties:
        _id:
          type: string
          description: ID unique de la zone (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        name:
          type: string
          description: Nom de la zone.
          example: "Zone Lausanne"
        description:
          type: string
          description: Description de la zone.
          example: "Zone couvrant le centre-ville de Lausanne."

      required:
        - name

    ZonesGeoJSON:
      type: object
      description: >
        Objet GeoJSON représentant un ensemble de zones (FeatureCollection).
      properties:
        type:
          type: string
          example: "FeatureCollection"
        features:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
                example: "Feature"
              geometry:
                type: object
                description: Géométrie GeoJSON (Polygon, MultiPolygon, etc.).
                properties:
                  type:
                    type: string
                    example: "Polygon"
                  coordinates:
                    type: array
                    description: Coordonnées GeoJSON.
                    items:
                      type: array
                      items:
                        type: array
                        items:
                          type: number
              properties:
                type: object
                description: Propriétés associées à la zone.
      required:
        - type
        - features
        # PARTIE SUR LES SHEMA DES GUESS
    Guess:
      type: object
      description: "Représente une tentative de localisation (guess) d'un utilisateur pour un post."
      properties:
        _id:
          type: string
          description: ID unique de la guess (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        score:
          type: number
          description: Score attribué pour cette tentative (calculé basé sur la distance).
          example: 985
        user:
          type: object
          description: Référence à l'utilisateur qui a fait la tentative.
          properties:
            _id:
              type: string
              description: ID de l'utilisateur (MongoDB ObjectId).
              example: "673a5e8f12c3b9f0a1234567"
            pseudo:
              type: string
              description: Pseudo de l'utilisateur.
              example: "player123"
        post:
          type: object
          description: Référence au post deviné.
          properties:
            _id:
              type: string
              description: ID du post (MongoDB ObjectId).
              example: "673a5e8f12c3b9f0a1234567"
            picture:
              type: string
              description: URL ou chemin de l'image du post.
              example: "/api/v1/posts/673a5e8f12c3b9f0a1234567/picture"
            latitude:
              type: number
              description: Latitude réelle du post.
              example: 46.5197
            longitude:
              type: number
              description: Longitude réelle du post.
              example: 6.6323
        createdAt:
          type: string
          format: date-time
          description: Timestamp de création de la guess.
          example: "2024-12-10T10:30:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Timestamp de dernière mise à jour de la guess.
          example: "2024-12-10T10:30:00.000Z"
      required:
        - score
        - user
        - post

        #  FIN PARTIE SUR LES SHEMA GUESS

    Post:
      type: object
      description: "Represents a post/publication with a picture and location."
      properties:
        _id:
          type: string
          description: Unique ID of the post (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        latitude:
          type: number
          description: Latitude coordinate of the post location.
          example: 46.5197
        longitude:
          type: number
          description: Longitude coordinate of the post location.
          example: 6.6323
        isValidated:
          type: boolean
          description: Indicates whether the post has been validated by an administrator.
          example: false
        userId:
          type: string
          description: ID of the user who created the post (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the post was created.
          example: "2024-12-10T10:30:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the post was last updated.
          example: "2024-12-10T10:30:00.000Z"
      required:
        - latitude
        - longitude
        - isValidated
    User:
      type: object
      description: "Represents a user in the system."
      properties:
        _id:
          type: string
          description: Unique ID of the user (MongoDB ObjectId).
          example: "673a5e8f12c3b9f0a1234567"
        pseudo:
          type: string
          description: The user's pseudonym.
          example: "player123"
        email:
          type: string
          description: The user's email address.
          example: "john@heig-vd.ch"
        team_id:
          type: string
          description: ID of the team the user belongs to (MongoDB ObjectId).
          example: "507f1f77bcf86cd799439011"
        is_admin:
          type: boolean
          description: Indicates if the user has admin privileges.
          example: false
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the user was created.
          example: "2024-12-10T10:30:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the user was last updated.
          example: "2024-12-10T10:30:00.000Z"
      required:
        - pseudo
        - email
        - team_id

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Message d'erreur.
          example: "Erreur serveur"
